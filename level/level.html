<!doctype html>
<html>
    <head>
    	<title> LEVEL </title>
   	    <style type="text/css">
	          canvas{
    		  border: 1px solid black;
              background: #0000ff;
              padding-left: 0;
              padding-right: 0;
              margin-left: auto;
              margin-right: auto;
              display: block;
              /*width: 800px;*/
	        	}
            h1#title{
             text-align: center;
            }
            #sidebar{
              position: relative;
              display: block;
              float: right;
              border: 1px solid black;


            }
	    </style>
	    <noscript>
  <!-- anchor linking to external file -->
  <div id="no-javascript" style="position: fixed; top: 0px; left: 0px; z-index: 3000; 
                height: 100%; width: 100%; background-color: #FFFFFF; ">
    <div style = "margin-left: 30px;">
      <h1>Oh No!</h1> <p> It appears you don't have javascript enabled. Please enable javascript to get the best use out of this page! </p>
    </div>
  </div>
</noscript>

      
    </head>
    <body>
      <div><a href="../index.html">index</a></div>
      <h1 id="title">levelRenderer Generator in Collision Detection Land </h1>
      <canvas id="canvas" width="800" height ="96">

      </canvas>
      <button id="go"> GO !!</button>
      <div id="sidebar">
        <p>use arrow keys to move.
        press up arrow to jump. </p>
        <label for="scale">scale: </label><button id="scale-button" value=1> 1x </button>

      </div>
      <input type="range" id="range" name="points" min="1" max="100">
      <div id="text"></div>

    </body>
      <script src="Map.js"></script>
      <script src="Block.js"></script>
      <script src="levelGen/levelGenerator.js"></script>
      <script src="levelGen/levelSettings.js"></script>
      <script src="levelGen/noise.js"></script>
      <script src="levelGen/Odds.js"></script>
      <script src="../game/GameObject.js"></script>
      <script>


      var lg = new levelGenerator(); 
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');
      var tiles;
      var map;
      var tileSize = 8;
      var rangeSlider = document.getElementById('range');
      var val = rangeSlider.value;
      var tileimage = new Image();
      tileimage.src = "../images/tiles8px.png";

      /**
      *
      *
      */
      function updateLevel(){
        var seedValue = rangeSlider.value || 1231231;
        this.map = lg.createNewMap(true, seedValue);
        map = this.map;
        tiles = this.map.tiles;

        resizeCanvas();
        drawMap(); 
      }

      /**
      *
      *
      */
      rangeSlider.addEventListener('change', function(){
        updateLevel();

        val = rangeSlider.value;
        document.getElementById('text').innerHTML = val;
      });

      /**
      *
      *
      */
      function resizeCanvas(){
      	canvas.width = tiles[0].length * tileSize;
      	canvas.height = tiles.length * tileSize;
      }

      /**
      *
      *
      */
      function drawMap(){
      	for(var row = 0; row < tiles.length; row++ ){
    			for(var col = 0; col < tiles[0].length; col++){
            var num = tiles[row][col];
            drawTile(num, row, col);
          }
    		}
        drawHeights();

      }

      function drawHeights(){
        ctx.beginPath();
        ctx.strokeStyle = "#ff0000";
        ctx.beginPath();
        var oldY = canvas.height;
        var oldX = 0;
        // ctx.moveTo(oldX, oldY);
        map.nodes.forEach(function(n){
          var x = n.index* tileSize;
          var y = n.height * tileSize;
          ctx.beginPath();
          ctx.moveTo(oldX, oldY);
          ctx.lineTo(x, y);
          ctx.stroke();
          oldX = x;
          oldY = y;
        });
      }

      function drawTile(num, row, col){
        var tx = num % 16;
        var ty = num / 16 | 0;

        ctx.drawImage(tileimage, tx*8 , ty * 8, 8, 8, col * tileSize, row * tileSize, tileSize, tileSize);
      }

      // function draw

      </script>




   
</html>